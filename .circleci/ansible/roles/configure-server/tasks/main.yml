---
- name: "Update apt-get using an equivalent command"
  apt:
   update_cache: yes

- name: "Add Node.js from Nodesource"
  become: true
  shell: |
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
    export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
    [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" # This loads nvm
    nvm install 13.8.0
    # sudo curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash -
    # sudo apt -y install nodejs
    
# - name: "Install Node.js 13"
#   become: true
#   apt:
#     name: ["nodejs"]
#     state: latest
#     update_cache: yes

- name: "Install PM2 Globally"
  npm:
    name: pm2
    global: yes

- name: "copy .env file to /etc/profile.d"
  become: true 
  copy:
    src: env.sh
    dest: /etc/profile.d/